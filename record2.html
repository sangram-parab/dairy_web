<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Customer Records | Krishna Dairy</title>
  <style>
    body {
      font-family: "Poppins", sans-serif;
      background: linear-gradient(135deg, #fff7e6, #ffe0b2);
      padding: 30px;
    }
    .container {
      background: #fff;
      border-radius: 15px;
      padding: 30px;
      box-shadow: 0 5px 15px rgba(0,0,0,0.2);
      max-width: 800px;
      margin: auto;
      animation: fadeIn 1s ease;
    }
    h1 { color: #ff9800; text-align: center; margin-bottom: 20px; }
    input {
      padding: 10px; margin: 10px; border-radius: 8px;
      border: 2px solid #ff9800; width: calc(30% - 20px);
    }
    button {
      background: #ff9800; color: white; border: none;
      padding: 10px 20px; border-radius: 8px; cursor: pointer;
      transition: 0.3s;
    }
    button:hover { background: #e68900; transform: scale(1.05); }
    table {
      width: 100%; border-collapse: collapse; margin-top: 25px;
    }
    th, td {
      border: 1px solid #ffcc80; padding: 10px; text-align: center;
    }
    th { background: #ffe0b2; color: #333; }
    #total {
      text-align: right; margin-top: 15px; font-weight: bold;
    }
    .top-bar { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
    .top-bar button { margin-left: 10px; }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="top-bar">
      <h1 id="custTitle">Customer Record</h1>
      <button onclick="goBack()">ðŸ”™ Change Customer</button>
    </div>

    <div>
      <input type="text" id="litre" placeholder="Litres">
      <input type="text" id="price" placeholder="Price per Litre">
      <input type="date" id="date">
      <button onclick="addRecord()">Add Record</button>
      <button style="background:red;" onclick="clearAll()">Clear All Records</button>
    </div>

    <table id="recordTable">
      <thead>
        <tr>
          <th>Customer Name</th>
          <th>Customer ID</th>
          <th>Date</th>
          <th>Litres</th>
          <th>Price</th>
          <th>Total (â‚¹)</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>

    <div id="total">Total Liability: â‚¹0</div>
  </div>

  <script>
    const customer = JSON.parse(localStorage.getItem("currentCustomer"));
    if (!customer) window.location.href = "index.html";

    const key = `records_${customer.id}`;
    document.getElementById("custTitle").textContent = `ðŸ„ ${customer.name}'s Record`;

    let records = JSON.parse(localStorage.getItem(key)) || [];

    const tbody = document.querySelector("#recordTable tbody");
    const totalEl = document.getElementById("total");

    function renderTable() {
      tbody.innerHTML = "";
      let total = 0;

      records.forEach(r => {
        const row = `<tr>
          <td>${r.name}</td>
          <td>${r.id}</td>
          <td>${r.date}</td>
          <td>${r.litre}</td>
          <td>${r.price}</td>
          <td>${r.total}</td>
        </tr>`;
        tbody.innerHTML += row;
        total += Number(r.total);
      });

      totalEl.textContent = `Total Liability: â‚¹${total.toFixed(2)}`;
    }

    function addRecord() {
      const litre = document.getElementById("litre").value;
      const price = document.getElementById("price").value;
      const date = document.getElementById("date").value;

      if (!litre || !price || !date) {
        alert("Please fill all fields.");
        return;
      }

      const total = (Number(litre) * Number(price)).toFixed(2);

      records.push({
        name: customer.name,
        id: customer.id,
        date, litre, price, total
      });

      localStorage.setItem(key, JSON.stringify(records));
      renderTable();
      alert("âœ… Record added successfully!");
      document.getElementById("litre").value = "";
      document.getElementById("price").value = "";
      document.getElementById("date").value = "";
    }

    function clearAll() {
      if (confirm("Are you sure you want to clear all records?")) {
        records = [];
        localStorage.removeItem(key);
        renderTable();
      }
    }

    function goBack() {
      window.location.href = "index.html";
    }

    renderTable();
  </script>
</body>
</html>

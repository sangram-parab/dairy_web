<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Consumer List</title>

  <style>
    body {
      font-family: Poppins, sans-serif;
      background: #f0f4ff;
      padding: 40px;
    }

    h2 { color: #333; margin-bottom: 20px; }

    .consumer-box {
      background: white;
      padding: 15px 20px;
      margin-bottom: 10px;
      border-radius: 10px;
      cursor: pointer;
      border: 2px solid #ff9800;
      transition: .2s;
    }

    .consumer-box:hover {
      background: #fff3e0;
    }

    button {
      padding: 12px 20px;
      margin-top: 20px;
      background: #ff9800;
      color: white;
      border: none;
      border-radius: 10px;
      font-size: 1rem;
      cursor: pointer;
    }
  </style>
</head>

<body>

  <h2 id="titleText">Loading...</h2>

  <div id="consumerList"></div>

  <button id="addBtn" style="display:none;" onclick="addConsumer()">Add New Consumer</button>

<script>
  const ROLE = localStorage.getItem("ROLE");

  const consumers = [
    { name: "Omkar", id: "100" },
    { name: "Sangram", id: "101" },
    { name: "Nikhil", id: "102" },
    { name: "Daksha", id: "103" },
    { name: "Pranav", id: "104" },
    { name: "Ayush", id: "105" },
    { name: "Sumant", id: "106" },
    { name: "Gaurav", id: "107" },
    { name: "Yash", id: "108" },
    { name: "Prabhat", id: "109" }
  ];

  const listDiv = document.getElementById("consumerList");
  const title = document.getElementById("titleText");

  if (ROLE === "OWNER") {
    title.innerText = "Select Consumer to Add Records";

    consumers.forEach(c => {
      const box = document.createElement("div");
      box.className = "consumer-box";
      box.innerText = `${c.name} (ID: ${c.id})`;
      box.onclick = () => openRecordPage(c.name, c.id);
      listDiv.appendChild(box);
    });

    document.getElementById("addBtn").style.display = "block";

  } else if (ROLE === "CONSUMER") {

    const user = JSON.parse(localStorage.getItem("currentConsumer"));
    title.innerText = "Your Account";

    const box = document.createElement("div");
    box.className = "consumer-box";
    box.innerText = `${user.name} (ID: ${user.id})`;
    box.onclick = () => openRecordPage(user.name, user.id);
    listDiv.appendChild(box);

  } else {
    title.innerText = "Error: No Role Found";
  }

  // Load next page
  function openRecordPage(name, id) {
    localStorage.setItem("selectedConsumer", JSON.stringify({ name, id }));
    window.location.href = "record.html";    // <-- MAIN WORKING LINE
  }

  // Owner adding new consumer
  function addConsumer() {
    const name = prompt("Enter new consumer name:");
    const id = prompt("Enter new consumer ID:");

    if (!name || !id) {
      alert("Both fields are needed.");
      return;
    }

    consumers.push({ name, id });
    alert("Consumer added! Refresh page.");
  }
</script>

</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Add Record</title>

  <style>
    body {
      font-family: Poppins, sans-serif;
      background: linear-gradient(135deg, #fff7e6, #ffe5c2);
      padding: 30px;
    }
    h2 { color: #ff9800; margin-bottom: 20px; }
    input {
      width: 95%; padding: 10px; margin: 10px 0;
      border: 2px solid #ff9800; border-radius: 8px; font-size: 1rem;
    }
    button {
      width: 95%; padding: 12px; background: #ff9800;
      color: white; border: none; border-radius: 10px;
      font-size: 1rem; cursor: pointer;
    }
    button:hover { background: #e68900; }
  </style>
</head>

<body>

  <h2 id="title">Add Record</h2>

  <input type="date" id="dateInput">
  <input type="number" id="litreInput" placeholder="Enter Milk (Litres)">
  <input type="number" id="rateInput" placeholder="Enter Rate Per Litre">

  <button onclick="saveRecord()">Save Record</button>

  <br><br>
  <button onclick="goBack()">Back</button>

<script>
  const user = JSON.parse(localStorage.getItem("selectedConsumer"));

  document.getElementById("title").innerText =
    `Add Record for ${user.name} (ID: ${user.id})`;

  function saveRecord() {
    const date = document.getElementById("dateInput").value;
    const litre = document.getElementById("litreInput").value;
    const rate = document.getElementById("rateInput").value;

    if (!date || !litre || !rate) {
      alert("Fill all fields");
      return;
    }

    // Key pattern: records_101, records_100, ...
    const key = `records_${user.id}`;

    let oldData = JSON.parse(localStorage.getItem(key)) || [];

    oldData.push({
      date,
      litre,
      rate,
      amount: parseFloat(litre) * parseFloat(rate)
    });

    localStorage.setItem(key, JSON.stringify(oldData));

    alert("Record Saved Successfully!");
    
    document.getElementById("dateInput").value = "";
    document.getElementById("litreInput").value = "";
    document.getElementById("rateInput").value = "";
  }

  function goBack() {
    window.location.href = "record2.html";
  }
</script>

</body>
</html>
